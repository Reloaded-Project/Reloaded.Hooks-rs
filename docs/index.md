---
hide:
  - toc
---

<div align="center">
	<h1>Reloaded Hooks NextGen</h1>
	<img src="Reloaded/Images/Reloaded-Icon.png" width="150" align="center" />
	<br/> <br/>
    Cross Platform, Cross Architecture re-implementation of Reloaded.Hooks.<br/>
    ü¶Ä Now in Crab ü¶Ä
</div>

## About

reloaded-hooks-rs is an enhanced port of the original [Reloaded.Hooks][Reloaded.Hooks] (<= 4.3.0) to Rust.

This library is written as `no_std`. Currently support for `Windows`, `Linux` and `macOS` is provided 
out of the box. That said, a lot of functionality is platform & architecture agnostic, hopefully making 
porting easier.  

## Platform Support

| Platform | x86   | x86_64 |
| -------- | ----- | ------ |
| Windows  | ‚úîÔ∏è     | ‚úîÔ∏è      |
| Linux    | ‚úîÔ∏è     | ‚úîÔ∏è      |
| macOS    | N/A * | ‚úîÔ∏è      |

* Apple dropped support for x86 platforms entirely; you can't run x86 code at all.

The `reloaded-hooks-rs` code is not hardwired to any platform. For other platforms you can fill the
[pending] struct and provide appropriate function pointers; which would possibly make the library work 
even in bare metal or embedded environments.

## Architecture Support

!!! info "Lists the currently available library features for different architectures."

| Feature                                                                                           | x86 & x64 | ARM64 |
| ------------------------------------------------------------------------------------------------- | --------- | ----- |
| [Basic Function Hooking](./dev/arch/overview.md#basic-function-hooking)                               | ‚úÖ         | ‚úÖ     |
| [Code Relocation](./dev/arch/overview.md#code-relocation)                                             | ‚úÖ ^1      | ‚úÖ ^1  |
| [Hook Stacking](./dev/arch/overview.md#hook-stacking)                                                 | ‚úÖ         | ‚úÖ     |
| [Calling Convention Wrapper Generation](./dev/arch/overview.md#calling-convention-wrapper-generation) | ‚úÖ         | ‚úÖ     |
| [Optimal Wrapper Generation](./dev/arch/overview.md#optimal-wrapper-generation)                       | ‚úÖ         | ‚úÖ     |

Bootstrapping a new architecture is not a difficult job!!  
Please see [Architecture Support Overview](./dev/arch/overview.md) for porting guidance.

^1 Only guaranteed for platforms supporting [Targeted Memory Allocation](./dev/platform/overview.md).

## Feature Support

- Supports common OSes/platforms.  
- Easy to integrate to new operating systems.  
- Calling Convention Translation (e.g. `__stdcall` -> `__fastcall`). 
- Strong interoperability. (incl. Hook stacking)  
- Parameter Injection (inject a 'context' parameter to your hooks).  
- Branch rewriting.  
- Mid function x86/x64 hooks (Cheat Engine style).  
- Optimal code generation.  
    - For [Relocated Code](./dev/arch/overview.md#code-relocation) and [Wrappers](./dev/arch/overview.md#optimal-wrapper-generation).
    - (The author is an anal optimization freak.) 

## Limitations

### No IP Relocation

!!! info "IP relocation is a thread safety technique employed by some libraries whereby all process' threads are stopped and any threads that are executing the prolog of the function that is being detoured at the same time have their instruction pointer overwritten to the hook."

This can only be done on some OSes that expose the relevant APIs.  
For the project author's use case, this is not needed, however the project would happily accept a 
PR for this functionality.  

In practice this is very, very rarely a problem.

### Caller Saved Registers Always saved in Entirety

!!! note "This applies to calling convention wrappers generated by the library."

!!! note "I've never seen this requirement in the wild, ever; usually for functions with this many parameters, they use standard ABI, but it's technically possible."

When generating wrappers between different calling conventions; the library preserves entire registers,
you can't for example specify 'please only preserve the upper 32-bits of register <x>'. As is, currently
only the whole register can be preserved.

## Technical Questions

If you have questions/bug reports/etc. feel free to [Open an Issue][OpenAnIssue].

Happy Documenting ‚ù§Ô∏è

[OpenAnIssue]: https://github.com/Reloaded-Project/Reloaded.Hooks-rs/issues/new
[Reloaded.Hooks]: https://github.com/Reloaded-Project/Reloaded.Hooks